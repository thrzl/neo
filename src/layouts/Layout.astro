---
import Header from "../components/Header.astro";
import Navbar from "../components/Navbar.astro";
import NowPlaying from "../components/NowPlaying.svelte";
import Status from "../components/Status.svelte";
import ClientRouter from "astro/components/ClientRouter.astro";
---

<script>
  window.addEventListener("beforeunload", () => {
    sessionStorage.setItem("scrollPosition", window.scrollY.toString());
  });
  // window.addEventListener("load", () => {
  //   const scrollPosition = sessionStorage.getItem("scrollPosition");
  //   if (scrollPosition) {
  //     window.scrollTo(0, parseInt(scrollPosition, 10));
  //     console.log(`Restoring scroll position to ${scrollPosition}`);
  //   }
  // });
</script>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>thrizzle</title>
    <link rel="icon" type="image/png" href="/skype/mantelpiece_clock.png" />
    <ClientRouter />
  </head>
  <body>
    <div class="wrapper w-full lg:w-3/4 m-auto my-10">
      <Header />

      <Navbar />
      <marquee class="bg-yellow absolute top-0 w-full py-2 md:hidden">
        <span
          style="font-family: 'Apple Garamond', serif; font-size: 1.2rem; color: #000;"
        >
          this site is designed for desktop. for the best experience, please
          visit on a computer or tablet. no promises for how this looks on
          mobile ‚úåüèΩ
        </span>
      </marquee>

      <div class="content">
        <aside class="sidebar-left" transition:persist>
          <section class="mb-4">
            <h2 class="font-800">status</h2>
            <Status client:only="svelte">
              <span slot="fallback" style="font-weight: bolder">loading</span> /
              please be patient <img
                height="16rem"
                src="/skype/thinking_face.png"
                alt="thinking face"
              />
            </Status>
          </section>
          <section>
            <div
              class="flex items-center justify-between"
              style="display: flex; justify-content: space-between; align-items: center;"
            >
              <h2 class="font-800 mb-0 border-b-0 mb-0" style="border: none">
                tunes
              </h2>
              <a
                style="font-family: Chicago; color: black; margin-top: 1rem; font-size: 0.65rem"
                href="/music">more music</a
              >
            </div>
            <NowPlaying client:only="svelte">
              <div
                class="flex flex-col lg:flex-row items-center border-black b-2"
              >
                <img
                  class="border-black border-2 w-[6rem] h-full m-2"
                  src="/skype/sign_of_the_horns.png"
                  alt="placeholder cover art"
                  style="width:5rem;padding:1rem;height: 100%"
                />
                <div
                  class="absolute bottom-0 op-0 group-hover:op-100 transition-delay-150 transition-200 w-full h-full z-1 flex justify-center items-center flex-col lowercase"
                >
                  <p
                    style="font-size: 1.25rem; font-weight: bold; margin:0; max-width: 400px"
                  >
                    now loading data...
                  </p>
                  <p style="margin:0">almost done!</p>
                </div>
              </div>
            </NowPlaying>
          </section>
        </aside>

        <main>
          <slot />
        </main>

        <aside class="sidebar-right">
          <section class="mb-4">
            <h2 class="font-800">changelog</h2>
            <p>yibber yabber</p>
          </section>
          <section>
            <h2 class="font-800">sum else idk what to put here</h2>
            <p>blah blah</p>
          </section>
        </aside>
      </div>

      <footer>
        <p class="text-red">version 4.3.2 | <a href="#">RSS feed</a> ‚Ä¶</p>
      </footer>
    </div>
  </body>
</html>

<style is:global>
  .box {
    border: 2px solid #000;
  }

  @font-face {
    font-family: "Apple Garamond";
    src: url("/fonts/Apple Garamond Bold Italic.woff2") format("woff2");
    font-weight: 700;
    font-style: italic;
    font-stretch: normal;
    unicode-range: U+0020-02DC;
  }

  @font-face {
    font-family: "Apple Garamond";
    src: url("/fonts/Apple Garamond Bold.woff2") format("woff2");
    font-weight: 700;
    font-style: normal;
    font-stretch: normal;
    unicode-range: U+0020-02DC;
  }

  @font-face {
    font-family: "Apple Garamond";
    src: url("/fonts/Apple Garamond Italic.woff2") format("woff2");
    font-weight: 400;
    font-style: italic;
    font-stretch: normal;
    unicode-range: U+0020-02DC;
  }

  @font-face {
    font-family: "Apple Garamond";
    src: url("/fonts/Apple Garamond.woff2") format("woff2");
    font-weight: 400;
    font-style: normal;
    font-stretch: normal;
    unicode-range: U+0020-02DC;
  }

  p {
    font-family: "Apple Garamond", serif;
    /* font-size: 18px;  */
    /* line-height: 1.2; */
  }
</style>

<style>
  body {
    background: #000;
    color: #000;
    font-family: "Apple Garamond", monospace;
    margin: 0;
  }
  .wrapper {
    background: #fff;
  }

  /* Header */
  header {
    display: flex;
    flex-direction: column;
    justify-content: end;
    color: #000;
    min-height: 650px;
    background-color: #000;
  }

  header h1 {
    font-size: 2rem;
    text-transform: lowercase;
    padding: 1rem;
    text-align: center;
  }

  header span {
    color: #ccc;
  }

  /* Top Navigation */
  .top-nav {
    background: #fff;
    border-bottom: 1px solid #000;
    border-left: 1.5px solid #000;
    border-right: 1.5px solid #000;
  }

  .top-nav ul {
    list-style: none;
    display: flex;
    justify-content: center;
    padding: 0.5rem;
    margin: 0;
  }

  .top-nav a {
    text-decoration: none;
    color: #000;
    font-weight: bold;
    padding: 0.5rem 1.5rem;
  }
  .top-nav a:hover {
    color: #fff;
    background: #000;
  }

  .content {
    display: flex;
    padding: 1rem;
    border-left: 1.5px solid #000;
    border-right: 1.5px solid #000;
  }

  .sidebar-left,
  .sidebar-right {
    width: 25%;
    padding: 0 1rem;
  }

  main {
    width: 50%;
    padding: 0 1rem;
  }

  .sidebar-left {
    border-right: 2px solid #000;
  }

  .sidebar-right {
    border-left: 2px solid #000;
  }

  h2 {
    border-bottom: 2px solid #000;
    /* padding-bottom: 0.25rem; */
    /* margin-bottom: 0.5rem; */
    text-transform: lowercase;
    font-size: 1.2rem;
  }

  .subtitle {
    font-style: italic;
    margin-bottom: 1rem;
  }

  p {
    margin: 0.5rem 0;
    line-height: 1.4;
  }

  footer {
    border-top: 2px solid #000;
    padding: 1rem;
    text-align: center;
    background: #eee;
  }

  footer a {
    color: #000;
    text-decoration: none;
  }
</style>
